<!DOCTYPE html>

<html lang="en-US">

<head>

  <meta charset="utf-8">

  <title>chemXbio</title>

  <link rel="stylesheet" type="text/css" href="mystyle.css">

  <script src = "mix.js"></script>
  <script src = "helper.js"></script>
  <script src = "Operation.js"></script>

</head>


<body>
<div id="experiment">

  <div class="leftside">

    <button onclick="showhidetoggle('operationsMenu'); createExperiment()">New experiment</button>

    <div id="operationsMenu" style="display: none">

      <table id="menu">
        <tr>
          <td><button id="addSub" onclick="showhidetoggle('substanceadd')">Add Substance</button></td>
          <td><button id="removeSub" onclick="showhidetoggle('substanceremoval')">Remove Substance</button></td>
        </tr>
      </table>

      <table>
        <tr>
          <td><button id="mixButton" onclick="showhidetoggle('mixtureform'); inputCreate()">Mix</button></td>
          <td><button id="heatButton" onclick="showhidetoggle('heat_coolform'); update()">Heat</button></td>
          <td><button id="splitButton" onclick="">Split</button></td>
          <td><button id="outputButton" onclick="">Output</button></td>
        </tr>
      </table>

      <button id="restButton" onclick="resetExperiment()">Reset Experiment</button>
      <button id="startButton" onclick="">Start Experiment</button>
      <button id="quit" onclick="toJson(experimentHolder); hideDiv('operationsMenu');
              showDiv('experiment'); resetExperiment()">Quit Experiment</button>

      <script>

          function createExperiment() {

              if (experimentHolder.length === 0) {

                  experimentHolder.push(experimentStructure);
              }
          }

          function addSub() {

              experimentStructure.EXPERIMENT.INPUTS = substancelist;
          }

          function addMix() {

              experimentStructure.EXPERIMENT.INSTRUCTIONS = operationList;

              //console.log(JSON.stringify(experimentStructure.EXPERIMENT.INSTRUCTIONS, null, 2));
          }

          function addHeat () {
              experimentStructure.EXPERIMENT.INSTRUCTIONS = operationList;
          }

          // window.location.reload()
      </script>

      <!-- Begin Substance Form -->
      <div id='substanceadd' style="display: none">
        <form id='subAddForm' method='post'>
          <fieldset>
          <legend>Add Substance</legend>
            <label for="substanceName">Input:</label>
            <input type='text' id='substanceName'>
            <br>
            <input type="button" onclick="inputSubstance(document.getElementById('substanceName').value);
                   update()" value="Add Substance">
            <input type="button" onclick="addSub(); showhidetoggle('substanceadd')"
                   value="Done">
            <br>
            <br>
            <div id="substanceDisplay">
              <!-- shows list of currently entered user substances -->
            </div>
          </fieldset>
        </form>
      </div>
      <!-- End Substance Form -->


      <!-- Begin Substance Removal Form -->
      <div id="substanceremoval" style="display: none">
        <form id="subRemoveForm" method="post">
          <fieldset>
          <legend>Remove Substance</legend>
            <label for="removesubstanceList">Enter Substance to Remove:</label>
            <select id="removesubstanceList">
              <script>
                  substanceRemove();
              </script>
            </select>
            <br>
            <input type="button" onclick="removeSubstance(); update()" value="Remove">
            <input type="button" onclick="showhidetoggle('substanceremoval')" value="Done">
          </fieldset>
        </form>
      </div>
      <!-- End Substance Removal Form -->


      <!-- Begin Mixture Form -->
      <div id="mixtureform" style="display: none">
        <form id="mixForm" method="post">
          <fieldset>
            <legend>MIX</legend>
            <label for="mixName">Name:</label>
            <input type="text" id="mixName" name="" value="">
            <br>
            <br>
            <label for="mixInputAmount">How many inputs for mixture?</label>
            <select id="mixInputAmount" onchange="inputCreate()">
              <script>
                formInput();
              </script>
            </select>
            <br>
            <br>
            <label for="mixInput">Enter Mixtures:</label>
            <br>
            <div id="mixInput">
              <!-- container for dynamically making input fields -->
            </div>
            <label for="mixTemp">Enter Temp:</label>
            <input type="text" id="mixTemp">
            <select id="mixTempSign">
              <script>
                formTemperature('mixTempSign');
              </script>
            </select>
            <br>
            <label for="mixTime">Enter Time:</label>
            <input type="text" id="mixTime">
            <select id="mixDuration">
              <script>
                formTime('mixDuration');
              </script>
            </select>
            <br>
            <label for="mixOutputname">Output Name:</label>
            <input type="text" id="mixOutputName">
            <br>
            <br>
            <input type="button" onclick="createMixture()" value="Add Mix">
            <input type="button" onclick="addMix(); showhidetoggle('mixtureform')" value="Done">
          </fieldset>
        </form>
      </div>
      <!-- End Mixture Form -->


      <!-- Begin Heat Form -->
      <div id="heat_coolform">
        <form id="heatForm" method="post">
          <fieldset>
            <legend>Heat</legend>
            <label for="nameHeat">Name:</label>
            <input type="text" id="nameHeat">
            <br>
            <br>
            <label for="inputHeat">Select Inputs:</label>
            <select id="inputHeat">
              <!-- ADD HEAT INPUTS FOR SELECTION HERE -->
              <script>
                operationInput();
              </script>
            </select>
            <br>
            <br>
            <label for="heatTemp">Enter Temp:</label>
            <input type="text" id="heatTemp" name="" value="">
            <select id="heatTempSign">
              <script>
                  formTemperature('heatTempSign');
              </script>
            </select>
            <br>
            <label for="heatTime">Enter Time:</label>
            <input type="text" id="heatTime">
            <select id="heatDuration">
              <script>
                  formTime('heatDuration');
              </script>
            </select>
            <br>
            <br>
            <input type="button" onclick="createHeat()" value="Add Heat">
            <input type="button" onclick="addHeat(); showhidetoggle('heat_coolform')" value="Done">
          </fieldset>
        </form>
      </div>
      <!-- End Heat Form -->


      <script>

      function createHeat() {

        var operation = JSON.parse(JSON.stringify(operationStructure));

        operation.OPERATION.NAME = document.getElementById('nameHeat').value;
        operation.OPERATION.ID = createID();
        operation.OPERATION.CLASSIFICATION = 'HEAT';

        //inputVariable(operation, document.getElementById('inputHeat').value);

        var input = JSON.parse(JSON.stringify(variableInput));
        input.VARIABLE.NAME = document.getElementById('inputHeat').value;

        operation.OPERATION.INPUTS.push(input);

        inputTemperature(operation, document.getElementById('heatTemp').value, document.getElementById('heatTempSign').value);
        inputTime(operation, document.getElementById('heatTime').value, document.getElementById('heatDuration').value);

        operationList.push(operation);

        resetForm('heatForm');

      }

      function createMixture() {

        var operation = JSON.parse(JSON.stringify(operationStructure));

        operation.OPERATION.NAME = document.getElementById('mixName').value;
        operation.OPERATION.ID = createID();
        operation.OPERATION.CLASSIFICATION = 'MIX';

        var num = document.getElementById('mixInputAmount').value;

        for (i = 0; i < num; i++) {

            var tmpName = document.getElementById("input" + i).value;
            console.log(tmpName);
            var tmpVol = document.getElementById("inputvolume" + i).value;
            console.log(tmpVol);
            var tmpUnit = document.getElementById("inputvolumeUnits" + i).value;
            console.log(tmpUnit);

            inputVariable(operation, tmpName, tmpVol, tmpUnit);
        }

        inputTemperature(operation, document.getElementById('mixTemp').value, document.getElementById('mixTempSign').value);
        inputTime(operation, document.getElementById('mixTime').value, document.getElementById('mixDuration').value);
        operationOutput(operation, 'substance', document.getElementById('mixOutputName').value);

        operationList.push(operation);

        console.log(operationList[0].OPERATION.OUTPUTS[0].VARIABLE_DECLARATION.NAME);

        resetForm('mixForm');
        inputCreate();

      }
      </script>

    </div>  <!-- End of operationsMenu-->

  </div> <!-- End of left side -->



  <div class="rightside">

    <pre id="whereToPrint"></pre>

  </div> <!-- End of right side -->

</div> <!-- End of experiment -->


</body>


</html>
